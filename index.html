<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>J√§gerausbildung MeckPomm QuizApp</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --main-bg: #eaf6ed;
      --main-bg-gradient: linear-gradient(135deg, #eaf6ed 0%, #d4e2fc 100%);
      --main-accent: #1a4d2e;
      --accent-light: #a5d6a7;
      --accent-strong: #238636;
      --error: #d72638;
      --card-bg: #fff;
      --card-bg-dark: #19262e;
      --btn-shadow: 0 2px 8px #0001;
      --border-radius: 16px;
      --progress-bg: #e3e3e3;
      --progress-accent: linear-gradient(90deg,#1a4d2e,#43c066);
      --btn-gradient: linear-gradient(90deg, #238636 70%, #43c066 100%);
      --btn-gradient-dark: linear-gradient(90deg, #357e4b 60%, #56c775 100%);
      --text: #222;
      --text-light: #fff;
      --feedback-correct: #238636;
      --feedback-wrong: #d72638;
    }
    [data-theme="dark"] {
      --main-bg: #1d2837;
      --main-bg-gradient: linear-gradient(135deg, #1e2c3b 0%, #2b3850 100%);
      --card-bg: var(--card-bg-dark);
      --main-accent: #43c066;
      --accent-light: #355646;
      --progress-bg: #22313a;
      --text: #e6e6e6;
      --btn-gradient: var(--btn-gradient-dark);
    }
    html, body {
      height: 100%;
      min-height: 100vh;
    }
    body {
      background: var(--main-bg-gradient);
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      color: var(--text);
      transition: background 0.4s, color 0.4s;
      min-height: 100vh;
    }
    .container {
      max-width: 460px;
      margin: 38px auto 0 auto;
      background: var(--card-bg);
      padding: 30px 22px 32px 22px;
      border-radius: var(--border-radius);
      box-shadow: var(--btn-shadow);
      display: flex;
      flex-direction: column;
      align-items: stretch;
      transition: box-shadow 0.3s, transform 0.3s, background 0.3s;
      position: relative;
      animation: cardFadeIn 0.6s;
    }
    .container:hover {
      box-shadow: 0 8px 32px #0003;
      transform: translateY(-4px) scale(1.012);
    }
    @keyframes cardFadeIn {
      0% { opacity: 0; transform: translateY(24px);}
      100% { opacity: 1; transform: none;}
    }
    h1 {
      font-size: 2.2rem;
      color: var(--main-accent);
      text-align: center;
      margin-bottom: 10px;
      letter-spacing: 1.2px;
      font-weight: 600;
    }
    .toggle-dark {
      position: absolute;
      top: 22px; right: 22px;
      background: transparent;
      border: none;
      font-size: 1.4em;
      cursor: pointer;
      color: var(--main-accent);
      opacity: 0.8;
      transition: color 0.2s, opacity 0.2s;
      z-index: 3;
    }
    .toggle-dark:hover { color: #fbc02d; opacity: 1;}
    .quiz-progress {
      color: #444;
      font-size: 1rem;
      margin: 0 0 6px 0;
      text-align: right;
      letter-spacing: 0.1px;
    }
    .progressbar {
      height: 7px;
      background: var(--progress-bg);
      border-radius: 4px;
      margin-bottom: 14px;
      overflow: hidden;
    }
    #progressbar-inner {
      height: 100%;
      background: var(--progress-accent);
      border-radius: 4px;
      transition: width 0.4s;
      width: 0;
    }
    .question {
      font-size: 1.18rem;
      margin-bottom: 22px;
      color: var(--text);
      font-weight: 500;
      min-height: 40px;
    }
    .answers {
      margin-bottom: 14px;
      display: flex;
      flex-direction: column;
      gap: 11px;
      animation: fadeIn 0.4s;
    }
    @keyframes fadeIn {
      0% { opacity: 0; transform: translateY(18px);}
      100% { opacity: 1; transform: none;}
    }
    .answer {
      background: var(--main-bg);
      border-radius: 12px;
      padding: 14px 18px;
      border: 2px solid #cce3d4;
      font-size: 1.05rem;
      transition: background 0.18s, border 0.15s, color 0.18s;
      cursor: pointer;
      margin-bottom: 0;
      box-shadow: 0 2px 8px #0001;
      display: flex;
      align-items: center;
      gap: 10px;
      user-select: none;
      color: var(--text);
      min-height: 38px;
    }
    .answer input[type="radio"] {
      accent-color: var(--main-accent);
      width: 1.1em;
      height: 1.1em;
      margin-right: 7px;
      cursor: pointer;
    }
    .answer.selected,
    .answer:hover {
      background: var(--accent-light);
      border-color: var(--main-accent);
    }
    .answer input[disabled] + span {
      color: #888;
    }
    .btn {
      padding: 13px 26px;
      background: var(--btn-gradient);
      color: var(--text-light);
      border: none;
      border-radius: 8px;
      font-size: 1.08em;
      font-weight: 500;
      margin-top: 10px;
      cursor: pointer;
      box-shadow: 0 1px 7px #23863633;
      transition: background 0.13s, transform 0.12s, filter 0.2s;
      min-width: 112px;
      outline: none;
    }
    .btn:active { transform: scale(0.98);}
    .btn:disabled {
      background: #b7c8be;
      color: #eee;
      cursor: not-allowed;
      filter: grayscale(0.6);
    }
    .download-btn {
      background: linear-gradient(90deg, #357e4b 70%, #5ba96e 100%);
      margin-top: 20px;
      margin-bottom: 0;
    }
    .restart-btn {
      background: linear-gradient(90deg, #476fa9 70%, #5f97ea 100%);
      margin-top: 14px;
      margin-bottom: 6px;
    }
    .btn-icon { margin-right: 6px; }
    .feedback {
      font-size: 1.16em;
      margin: 21px 0 6px 0;
      min-height: 38px;
      text-align: center;
      font-weight: 500;
      letter-spacing: 0.4px;
    }
    .correct { color: var(--feedback-correct);}
    .incorrect { color: var(--feedback-wrong);}
    .result {
      font-size: 1.22em;
      margin-top: 24px;
      text-align: center;
      color: var(--main-accent);
      font-weight: 600;
    }
    .trophy {
      font-size: 2.6em;
      margin-bottom: 14px;
      text-align: center;
      animation: fadeIn 0.8s;
    }
    @media (max-width: 600px) {
      .container { max-width: 98vw; padding: 13px 3vw 17px 3vw;}
      h1 { font-size: 1.27rem;}
      .btn, .download-btn, .restart-btn { padding: 13px 2vw;}
    }
  </style>
</head>
<body>
  <div class="container" id="main-container">
    <button class="toggle-dark" id="darkToggle" title="Dark/Light Mode">üåô</button>
    <h1>J√§gerausbildung MeckPomm QuizApp</h1>
    <div id="quiz-progress" class="quiz-progress"></div>
    <div class="progressbar"><div id="progressbar-inner"></div></div>
    <div id="quiz"></div>
    <button id="okBtn" class="btn" disabled><span class="btn-icon">‚úÖ</span>OK</button>
    <button id="nextBtn" class="btn" disabled style="display:none;"><span class="btn-icon">‚û°Ô∏è</span><span id="nextBtnText">N√§chste Frage</span></button>
    <div id="feedback" class="feedback"></div>
    <div id="result" class="result"></div>
    <button id="downloadLog" class="btn download-btn" style="display:none;">Antwort-Log herunterladen</button>
    <button id="restartBtn" class="btn restart-btn" style="display:none;">Quiz neu starten</button>
  </div>
  <script>
    // Darkmode Toggle
    const darkToggle = document.getElementById('darkToggle');
    function setTheme(dark) {
      document.documentElement.setAttribute('data-theme', dark ? 'dark' : '');
      darkToggle.textContent = dark ? '‚òÄÔ∏è' : 'üåô';
      localStorage.setItem('quizapp_dark', dark ? '1' : '0');
    }
    darkToggle.onclick = () => setTheme(document.documentElement.getAttribute('data-theme') !== 'dark');
    if (localStorage.getItem('quizapp_dark') === '1'
        || (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      setTheme(true);
    }

    // Quiz-JSON
    const quizData = [
      {
        "id": 174,
        "question": "Welche der folgenden Arten geh√∂ren zur Ordnung der Nagetiere?",
        "answers": [
          { "text": "Feldhase, Igel", "isCorrect": false },
          { "text": "Bisam, Biber", "isCorrect": true },
          { "text": "Wildkaninchen, Reh", "isCorrect": false }
        ]
      },
      {
        "id": 175,
        "question": "Zu welcher Familie geh√∂rt der Dachs?",
        "answers": [
          { "text": "Kleinb√§ren", "isCorrect": false },
          { "text": "Hundeartige", "isCorrect": false },
          { "text": "Marderartige", "isCorrect": true }
        ]
      },
      {
        "id": 178,
        "question": "Welche Tierarten haben einen Pansen?",
        "answers": [
          { "text": "Rotwild und Muffelwild", "isCorrect": true },
          { "text": "Rehwild und Hase", "isCorrect": false },
          { "text": "Damwild und Enten", "isCorrect": false }
        ]
      },
      {
        "id": 199,
        "question": "Wann wirft der Rehbock das Geh√∂rn ab?",
        "answers": [
          { "text": "Februar bis M√§rz", "isCorrect": false },
          { "text": "Juni bis August", "isCorrect": false },
          { "text": "Oktober bis Dezember", "isCorrect": true }
        ]
      },
      {
        "id": 235,
        "question": "Wie oft setzt die Kaninchenh√§sin j√§hrlich?",
        "answers": [
          { "text": "Ein- bis zweimal", "isCorrect": false },
          { "text": "Vier- bis sechsmal", "isCorrect": true },
          { "text": "Sechs- bis neunmal", "isCorrect": false }
        ]
      },
      {
        "id": 254,
        "question": "An welchem Merkmal kann man das Hermelin gut vom Mauswiesel unterscheiden?",
        "answers": [
          { "text": "Am wei√üen R√ºcken.", "isCorrect": false },
          { "text": "An der schwarzen Unterseite", "isCorrect": false },
          { "text": "An der schwarzen Schwanzspitze", "isCorrect": true }
        ]
      }
    ];

    let current = 0;
    let userAnswers = [];
    let hasAnswered = false;
    let shuffledAnswers = [];

    function shuffleArray(array) {
      let arr = array.slice();
      for (let i = arr.length - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function showQuestion() {
      const quiz = document.getElementById('quiz');
      const q = quizData[current];
      hasAnswered = false;

      // Shuffle answers for this question and store
      shuffledAnswers = shuffleArray(q.answers);

      // Fortschritt + Progressbar
      document.getElementById('quiz-progress').textContent = `Frage ${current + 1} von ${quizData.length}`;
      const progress = ((current+1)/quizData.length)*100;
      document.getElementById('progressbar-inner').style.width = progress+"%";

      let html = `<div class="question">${q.question}</div><div class="answers">`;

      shuffledAnswers.forEach((a, idx) => {
        html += `
          <label class="answer">
            <input type="radio" name="answer" value="${idx}"><span>${a.text}</span>
          </label>`;
      });

      html += `</div>`;
      quiz.innerHTML = html;

      // Buttons/Feedback Zustand
      document.getElementById('okBtn').disabled = true;
      document.getElementById('okBtn').style.display = '';
      document.getElementById('nextBtn').disabled = true;
      document.getElementById('nextBtn').style.display = 'none';
      document.getElementById('feedback').textContent = "";
      document.getElementById('result').textContent = "";
      document.getElementById('downloadLog').style.display = 'none';
      document.getElementById('restartBtn').style.display = 'none';

      // Letzte Frage? Button-Text √§ndern
      const nextBtnText = document.getElementById('nextBtnText');
      if (current === quizData.length - 1) {
        nextBtnText.textContent = "Zum Ergebnis";
      } else {
        nextBtnText.textContent = "N√§chste Frage";
      }

      // Auswahl markieren
      document.querySelectorAll('input[name="answer"]').forEach(input => {
        input.addEventListener('change', () => {
          if (hasAnswered) return;
          document.getElementById('okBtn').disabled = false;

          // Visuelle Hervorhebung
          document.querySelectorAll('.answer').forEach(label => label.classList.remove('selected'));
          if (input.checked) input.parentElement.classList.add('selected');
        });
      });
    }

    document.getElementById('okBtn').addEventListener('click', () => {
      if (hasAnswered) return;
      const selected = document.querySelector('input[name="answer"]:checked');
      if (!selected) return;

      const answerIdx = parseInt(selected.value);
      const q = quizData[current];
      const isCorrect = shuffledAnswers[answerIdx].isCorrect;
      const correctAnswerText = shuffledAnswers.find(a => a.isCorrect).text;
      hasAnswered = true;

      userAnswers.push({
        id: q.id,
        question: q.question,
        givenAnswer: shuffledAnswers[answerIdx].text,
        correct: isCorrect,
        correctAnswer: correctAnswerText
      });

      // Feedback
      const feedback = document.getElementById('feedback');
      if (isCorrect) {
        feedback.innerHTML = `<span class="correct">‚úÖ Richtig!</span><br><span>Richtige Antwort: ${correctAnswerText}</span>`;
      } else {
        feedback.innerHTML = `<span class="incorrect">‚ùå Falsch!</span><br><span>Richtige Antwort: ${correctAnswerText}</span>`;
      }

      // Radio-Buttons deaktivieren
      document.querySelectorAll('input[name="answer"]').forEach(input => input.disabled = true);

      document.getElementById('okBtn').disabled = true;
      document.getElementById('okBtn').style.display = 'none';
      document.getElementById('nextBtn').disabled = false;
      document.getElementById('nextBtn').style.display = '';
    });

    document.getElementById('nextBtn').addEventListener('click', () => {
      current++;
      if (current < quizData.length) {
        showQuestion();
      } else {
        showResult();
      }
    });

    function showResult() {
      document.getElementById('quiz').innerHTML = '';
      document.getElementById('quiz-progress').textContent = "";
      document.getElementById('progressbar-inner').style.width = "100%";
      let correctCount = userAnswers.filter(a => a.correct).length;
      document.getElementById('result').innerHTML =
        `<div class="trophy">üèÜ</div>Quiz beendet!<br>Du hast <b>${correctCount}</b> von <b>${quizData.length}</b> Fragen richtig beantwortet.`;

      // Download- und Restart-Button zeigen
      document.getElementById('downloadLog').style.display = '';
      document.getElementById('restartBtn').style.display = '';
      document.getElementById('nextBtn').style.display = 'none';
      document.getElementById('okBtn').style.display = 'none';
      document.getElementById('feedback').textContent = "";
    }

    document.getElementById('downloadLog').addEventListener('click', () => {
      let log = '';
      userAnswers.forEach((a, idx) => {
        log += `Frage ${idx + 1} (ID: ${a.id}): ${a.question}\n`;
        log += `Deine Antwort: ${a.givenAnswer}\n`;
        log += `Korrekt? ${a.correct ? 'JA' : 'NEIN'}\n`;
        log += `Richtige Antwort: ${a.correctAnswer}\n\n`;
      });
      const blob = new Blob([log], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);

      const link = document.createElement('a');
      link.href = url;
      link.download = 'quiz-log.txt';
      link.click();

      URL.revokeObjectURL(url);
    });

    document.getElementById('restartBtn').addEventListener('click', () => {
      current = 0;
      userAnswers = [];
      showQuestion();
    });

    // Start
    showQuestion();
  </script>
</body>
</html>
